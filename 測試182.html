<!DOCTYPE html>
<html lang="zh-Hant-TW">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<style>
			html {
				font-family: Arial, Helvetica, sans-serif;
			}

			section {
				display: flex;
			}

			article {
				margin-left: 10rem;
			}

			article * {
				max-width: 30rem;
			}

			ul {
				position: fixed;
				list-style-type: none;
				width: 10rem;
			}

			a {
				text-decoration: none;
				color: black;
			}

			a:hover {
				color: blue;
			}

			.active {
				color: blue;
			}
		</style>
	</head>
	<body>
		<section>
			<ul>
				<li><a href="#introduction">Introduction</a></li>
				<li><a href="#heading1">Heading 1</a></li>
				<li><a href="#heading2">Heading 2</a></li>
				<li><a href="#heading3">Heading 3</a></li>
			</ul>
			<article>
				<h1>Article</h1>
				<h2 id="introduction">Introduction</h2>
				<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Iste fuga quidem, ratione quae animi eaque! Nihil, cum suscipit sapiente magnam ratione ab voluptas odit totam. Molestiae magni iusto deserunt dolor?</p>
				<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Iusto error consectetur harum dolor voluptatem cum laborum ipsa veritatis molestias aliquam, tempora minima dignissimos itaque repellendus praesentium commodi laboriosam quae suscipit.</p>
				<h2 id="heading1">Heading 1</h2>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Odit iure inventore perspiciatis illo ipsum, natus et animi tenetur eum facere? Fuga libero amet quae quis doloremque animi ex cumque voluptate?</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Aut reiciendis accusamus distinctio laboriosam harum optio exercitationem eveniet dolorum, doloremque voluptates voluptas dolore, nisi quisquam dicta officia voluptatum sequi sed autem.</p>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Autem recusandae amet quidem eveniet officia, hic obcaecati dolores! Iste aliquam alias culpa. Minima quam quas error mollitia architecto odio voluptatem debitis.</p>
				<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consequatur aperiam, ipsa in, culpa reprehenderit sint ut quis pariatur corporis dolores, delectus aliquam! Aperiam inventore dolor officia? Totam consectetur quisquam aliquam.</p>
				<h2 id="heading2">Heading 2</h2>
				<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Iste fuga quidem, ratione quae animi eaque! Nihil, cum suscipit sapiente magnam ratione ab voluptas odit totam. Molestiae magni iusto deserunt dolor? Lorem ipsum dolor sit amet consectetur, adipisicing elit. Nemo earum dicta maxime eaque possimus, labore eum vitae eius error. Odio pariatur corrupti nesciunt mollitia laborum aliquam enim rerum, nobis iure.</p>
				<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Iste fuga quidem, ratione quae animi eaque! Nihil, cum suscipit sapiente magnam ratione ab voluptas odit totam. Molestiae magni iusto deserunt dolor?</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Molestias facilis et voluptatibus! Inventore quia libero saepe. Rerum, quas deleniti nisi assumenda dolorem quisquam distinctio perspiciatis nesciunt ratione, eius omnis sit?</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Blanditiis culpa assumenda corporis ducimus, nobis adipisci possimus, dolorem labore, sit recusandae impedit asperiores delectus repellendus at minima beatae dolores nisi ratione.</p>
				<h2 id="heading3">Heading 3</h2>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Voluptates accusantium quo cumque doloremque modi, esse inventore fugit, deserunt optio excepturi vero impedit autem culpa est saepe doloribus quas dolore voluptatum.</p>
				<p>Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nobis facere sunt asperiores delectus culpa earum velit, voluptates doloribus magni perspiciatis praesentium aliquam placeat vitae deleniti facilis rem! Veritatis, praesentium consequatur.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. In culpa magnam aliquid alias aspernatur iure, deleniti labore provident totam eos illum accusantium vitae quia tempore eius omnis. Aliquid, asperiores fuga.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Ea blanditiis cupiditate aut, sit voluptate quo at ex cumque? Ullam facilis quasi laboriosam id iste minima! Minus consequuntur quam aut cupiditate.</p>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Ea blanditiis cupiditate aut, sit voluptate quo at ex cumque? Ullam facilis quasi laboriosam id iste minima! Minus consequuntur quam aut cupiditate.</p>
			</article>
		</section>
		<script>
			function isElementInViewport(el) {
				var rect = el.getBoundingClientRect();
				console.log(el, rect);
				return rect.top >= -1 && rect.left >= 0 && rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) && rect.right <= (window.innerWidth || document.documentElement.clientWidth);
			}
			const handler = (entries) => {
				console.log(entries);
				// Get all the links from the side menu
				const allLinks = document.querySelectorAll("ul li a");

				// Get all the sections we want to track
				const allSections = document.querySelectorAll("h2");

				// Get all entries that have just come into the viewport
				const allEntries = new Set(entries.filter((entry) => entry.isIntersecting == true).map((entry) => entry.target));

				let currentSection;

				// Look through all sections
				for (let i = 0; i < allSections.length; i++) {
					// Get the current section
					currentSection = allSections[i];
					// If the section is in the viewport or it has just intersected, set it as active
					if (isElementInViewport(currentSection) || allEntries.has(currentSection)) {
						// Set all links as inactive
						allLinks.forEach((link) => link.classList.remove("active"));
						// Set current link to active
						document.querySelector(`a[href="#${currentSection.id}"]`).classList.add("active");
						// Exit loop after setting first active link
						break;
					}
				}
			};

			// Create a new observer with the handler
			const observer = new IntersectionObserver(handler);

			// Observe all headings on our webpage
			document.querySelectorAll("h2").forEach((section) => {
				observer.observe(section);
			});
		</script>
	</body>
</html>
