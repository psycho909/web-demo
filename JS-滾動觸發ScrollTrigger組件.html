<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,IE=8" />
		<title>《全民打棒球2 Online》</title>
		<link rel="stylesheet" href="css/main.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
			}
			ul {
				list-style: none;
				position: fixed;
				font-size: 0;
				margin: 12px 0;
				z-index: 999;
			}
			.block {
				height: 100px;
			}
			ul li {
				display: inline-block;
				width: 100px;
				height: 60px;
				cursor: pointer;
				background-color: silver;
				text-align: center;
				line-height: 60px;
				font-size: 16px;
				margin: 0 12px;
			}
			ul li.active {
				background-color: rgb(255, 0, 179);
			}

			#tab1 {
				background-color: gold;
			}

			#tab2 {
				background-color: green;
			}

			#tab3 {
				background-color: blue;
			}
			.totop {
				width: 50px;
				height: 50px;
				border-radius: 50%;
				background-color: #e8eac9;
				text-align: center;
				line-height: 50px;
				position: fixed;
				right: 30px;
				bottom: 30px;
				cursor: pointer;
			}
			.tab {
				width: 100%;
				height: 500px;
				position: relative;
			}
			.box {
				width: 200px;
				height: 200px;
				border: 2px solid #ddd;
				background-color: #fff;
				position: absolute;
				transition: all 0.3s linear;
			}
			.tab.active .box {
				transform: translateX(100px);
			}
			.footer {
				width: 100%;
				height: 80px;
				background-color: #000;
				color: #fff;
			}
		</style>
	</head>
	<body>
		<ul class="nav">
			<li data-name="tab1" class="active">1</li>
			<li data-name="tab2">2</li>
			<li data-name="tab3">3</li>
			<li data-name="tab4">4</li>
		</ul>
		<div id="tab1" class="tab" data-name="tab1">
			<div class="box">tab1</div>
		</div>
		<div id="tab2" class="tab" data-name="tab2">
			<div class="box">tab2</div>
		</div>
		<div id="tab3" class="tab" data-name="tab3">
			<div class="box">tab3</div>
		</div>
		<div id="tab4" class="tab" data-name="tab4">
			<div class="box">tab4</div>
		</div>
		<div class="footer">footer</div>
		<div class="totop">top</div>
	</body>
	<script>
		$(function () {
			$(".nav li").on("click", function () {
				var _index = $(this).index();
				var _top = $("#tab" + (_index + 1)).offset().top;
				$("body,html").animate(
					{
						scrollTop: _top,
					},
					500
				);
			});

			function ScrollTrigger(target, offset) {
				this.target = target;
				this.curr;
				this.offset = 150 || offset;
				this.enterCallback;
				this.leaveCallback;
			}
			ScrollTrigger.prototype.scroll = function () {
				var _this = this;
				$(window).scroll(function () {
					var _top = $(document).scrollTop();
					$(_this.target).each(function (i, v) {
						_this.offset = $(this).outerHeight() / 2;
						if ($(this).offset().top - _this.offset <= _top && $(this).offset().top + $(this).outerHeight() - _this.offset > _top) {
							if (!$(this).data("trigger")) {
								$(this).data("trigger", true);
								_this.curr = $(this)[0];
								_this.enterCallback();
							}
							return true;
						} else {
							if ($(this).data("trigger")) {
								$(this).data("trigger", false);
								_this.curr = $(this)[0];
								_this.leaveCallback();
							}
							return true;
						}
					});
				});
				return this;
			};
			ScrollTrigger.prototype.enter = function (fn) {
				this.enterCallback = fn;
				return this;
			};
			ScrollTrigger.prototype.leave = function (fn) {
				this.leaveCallback = fn;
				return this;
			};

			var s = new ScrollTrigger(".tab", 150);
			s.scroll()
				.enter(function () {
					$(".nav li[data-name=" + $(this.curr).attr("data-name") + "]").addClass("active");
					console.log("enter", this.curr);
				})
				.leave(function () {
					$(".nav li[data-name=" + $(this.curr).attr("data-name") + "]").removeClass("active");
					console.log("leave", this.curr);
				});
		});
	</script>
</html>
