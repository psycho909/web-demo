<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    *{
        padding: 0;
        margin: 0;
        box-sizing: border-box;
    }
    .box-wrap{
        width: 600px;
        height: 600px;
        border:1px solid #000;
        overflow: hidden;
        position: relative;
    }
    .box-wrap:before{
        content:"";
        width: 1px;
        height: 100%;
        background-color: #000;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
        z-index: 3;
    }
    .box-wrap:after{
        content:"";
        width: 100%;
        height: 1px;
        background-color: #000;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
        z-index: 3;
    }
    .bg{
        width: 1800px;
        height: 1800px;
        position: absolute;
        top: 0;
        right: 0;
        background-image: url('../images/bgg.jpg');
    }
    .box{
        width: 30px;
        height: 30px;
        background-color: red;
        border-radius: 50%;
        position: absolute;
    }
    .box1{
        top: 186px;
        right: 198px;
        transform: translate(0,0);
    }
    .box2{
        top: 135px;
        right: 254px;
        transform: translate(0,0);
        background-color: blue;
    }
    </style>
</head>
<body>
    <button id="play">play</button>
    <button id="stop">stop</button>
    <div class="box-wrap">
        <div class="bg">
            <div class="box box1"></div>
            <div class="box box2"></div>
        </div>
    </div>
    <script src="https://tw.hicdn.beanfun.com/jquery/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.0.1/dist/gsap.min.js"></script>
    <script>
        var $box=$(".box");
        var hight=0;
        function getTranslate3d (el) {
            var values = el.style.transform.split(/\w+\(|\);?/);
            if (!values[1] || !values[1].length) {
                return [];
            }
            return values[1].split(/,\s?/g);
        }
        function getRandom(min, max) {
            return Math.random() * (max - min) + min;
        }
        gsap.globalTimeline.pause()
        // t2.to(".bg",20,{x:1200,y:-1200})
        var arr=[];
        $(".box").each(function(i,v){
            
            gsap.to($(v),getRandom(15,20),{x:-1328,y:1328,onUpdate:function(){
                var _x=Math.abs(getTranslate3d($box[0])[0].replace("px",""));
                // arr[i]=_x;
                // _x=Math.max.apply(null,arr)
                if(_x > hight){
                    hight=_x
                }
                if(hight >= 80){
                    var x=hight-80;
                    var y=hight-80;
                    if(x >= 1200){
                        x=1200;
                        y=1200
                    }
                    $(".bg").css("transform","translate("+x+"px,"+-y+"px)")
                }
            }})
        })
        
        $("#play").on("click",function(){
            gsap.globalTimeline.play() 
        })
        $("#stop").on("click",function(){
            gsap.globalTimeline.pause()
        })
    </script>
</body>
</html>